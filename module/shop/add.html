<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>臭美管理后台</title>
        <link rel="stylesheet" href="../../awesome/css/font-awesome.min.css" />
        <link rel="stylesheet" href="../../css/reset.css" />
        <link rel="stylesheet" href="../../css/global.css" />
        <link rel="stylesheet" href="../../css/admin.css" />    
        <link rel="stylesheet" href="shop.css" />    
    </head>

    <body>
        <div class="breadcrumb">
            <a class="link" href="ui.html">一级导航</a>
            <span>&gt;</span>
            <a class="link" href="ui.html">二级导航</a>
            <span>&gt;</span>新增店铺
        </div>

        <div class="wrapper">
            <form novalidate="" method="post" class="form-vertical" data-role="form" action="/data/post.json">
                <div class="control-group">
                    <label class="control-label" for="">*店铺编号：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*店铺名称：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*所属商户：</label>
                    <div class="control">
                        <input type="text" disabled>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*店铺地址：</label>
                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>
                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>
                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select><br>
                    <textarea class="textarea" id="address" placeholder="详细街道信息"></textarea>
                    <div class="textarea-bar">
                        <span class="area-coor">地理坐标：</span>
                        <span id="coorMarker">未标记</span>
                        <button class="btn area-btn" id="addCoordinate">
                            <i class="fa fa-map-marker"></i> 
                            <span>添加坐标</span>
                        </button>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*所属商圈：</label>
                    <input type="radio" name="area" class="label">
                    <label for="area1">南山区</label>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*店铺类型：</label>
                    <input type="radio" name="sex" class="radio" id="radio1"><label for="radio1">预付款店</label>
                    <input type="radio" name="sex" class="radio" id="radio2"><label for="radio2">投资店</label>
                    <input type="radio" name="sex" class="radio" id="radio3"><label for="radio3">金字塔店</label>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*合同日期：</label>
                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>

                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>

                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*合同限期：</label>
                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>

                    <select class="select min-width">
                        <option value="1">深圳</option>
                    </select>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*合同编号：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for="">*联系人：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*联系电话：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*店铺电话：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*法人代表：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*法人电话：</label>
                    <div class="control">
                        <input type="text">
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for="">*业务代表：</label>
                    <select class="select" style="width:20%;min-width:250px">
                        <option value="1">深圳</option>
                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""></label>
                    <button class="btn" style="margin-right:20px">预览</button>
                    <a href="bank.html">
                        <button class="btn-primary">下一步</button>
                    </a>
                </div>                                                                                         
            </form>       
        </div>

        <div id="pop-wapper" class="hide">
            <div class="mask"></div>
            <div class="popup noSelect">
                <div class="header-wapper">
                    <span class="pop-tip">标记地理坐标</span>
                    <span class="pop-close">×</span>
                </div>
                <div class="input-group search-wapper">
                    <input type="text" class="border-none" placeholder="请输入关键字" />
                    <button type="submit" class="fa fa-search"></button>
                </div>
                <div class="map-wapper" id="map-wapper"></div>
                <div class="map-bar-wapper">
                    <div class="bar-mark">
                        <strong>标记位置：</strong>
                        <span id="pop-geo-coor">未标注</span>
                    </div>
                    <div class="bar-group">
                        <button class="btn">取消</button>
                        <button class="btn-primary">确定</button>
                    </div>
                </div>                                
            </div>        
        </div>

        <script src="../../js/cfg.js"></script>
        <script src="../../js/jquery.min.js"></script>
        <script src="../../js/sea.js"></script>
        <script src="../../js/ejs.js"></script>
        <script src="../../js/lib.js"></script>
        <script src="../../js/iscroll.js"></script>
        <script src="../../js/admin.js"></script>
        <script src="../../js/frame.js"></script>
        <script src="http://api.map.baidu.com/api?v=2.0&ak=F360d7e9ea3c3ecb5b9b9f2b530be8f4&callback=renderMap()"></script>

        <script>
            $("#addCoordinate").on('click',function(){
                $("#pop-wapper").show();
            })

            $(".pop-close").on('click',function(){
                $("#pop-wapper").hide();
            });

            function renderMap (){
                $("#addCoordinate").on('click',function(){
                    var address = $("#address");
                    var geoCoor = $("#pop-geo-coor").text(address.val());
                    //在指定的容器内创建地图实例  
                    var map = new BMap.Map("map-wapper");
                    //创建一个地理坐标类 
                    var point = new BMap.Point(113.941893,22.535644);
                    //初始化地图位置（未进行初始化的地图将不能进行任何操作）
                    map.centerAndZoom(point,12);
                    //将平移缩放控件添加到地图上
                    map.addControl(new BMap.NavigationControl());
                    //启用滚轮放大缩小功能
                    map.enableScrollWheelZoom(true);
                    //根据point创建一个图像标注覆盖物实例
                    //var mk = new BMap.Marker(point);
                    //将覆盖物添加到地图中
                    //map.addOverlay(mk);
                    //将地图的中心点更改为给定的点
                    //map.panTo(point);
                    var marker;
                    var geolocation = new BMap.Geolocation();
                    var geoc = new BMap.Geocoder();
                    geolocation.getCurrentPosition(function(r) {
                        if (this.getStatus() == BMAP_STATUS_SUCCESS) {
                            marker = new BMap.Marker(r.point);
                            map.addOverlay(marker);
                            map.panTo(r.point);
                        }else{
                            $('#popup-alert').on('click',function(){
                                lib.popup.alert({text:'暂时无法获取您的位置'})
                            });
                        }
                    },{
                        enableHighAccuracy: true
                    });
                    
                    var addrPonit = {};
                    map.addEventListener("click", function(e) {
                        var point = e.point;
                        marker = new BMap.Marker(point);
                        map.clearOverlays();
                        map.addOverlay(marker);
                        geoc.getLocation(e.point, function(address) {
                            var component = address.addressComponents;
                            addrPonit['text'] = component.street + component.streetNumber;
                            addrPonit['coor'] = {lng:point.lng,lat:point.lat};
                            geoCoor.attr({"lat": point.lat,"lng": point.lng});
                            geoCoor.text(addrPonit.text);
                        });
                    });                    
                });
            }
        </script>          
    </body>
</html>