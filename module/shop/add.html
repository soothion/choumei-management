<!DOCTYPE html>
<html lang="zh-CN">
    <head>
      <meta charset="utf-8">
      <title>臭美管理后台</title>
      <script type="text/javascript" src="../../js/include.js"></script>
      <script type="text/javascript" src="../../js/utils.js"></script>
      <link rel="stylesheet" href="shop.css" />    
    </head>

    <body>
        <div class="breadcrumb">
            <a>店铺管理</a>
            <span>&gt;</span>
            <a href="index.html">店铺列表</a>
            <span>&gt;</span><%=query.type=="add"?"新增店铺":"编辑店铺"%>
        </div>
        
        <div class="wrapper">
          <ul class="nav-step flex-box">
            <li class="flex-item active"><span class="arrow">1.店铺基本信息</span></li>
            <li class="flex-item"><span>2.银行账号信息</span></li>
            <li class="flex-item"><span>3.准入评估信息</span></li>
            <li class="flex-item"><span>4.附件上传</span></li>
          </ul>

            <form novalidate="" class="form-vertical" data-role="form" id="form">
                <script type="text/template" id="form-t">  
                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>店铺编号：</label>
                    <div class="control">
                        <input type="text" name="sn" value="<%=data.sn%>" placeholder="店铺编号" maxlength="10" required unique="salon/checkSalonSn?sn=${value}" data-value="<%=data.sn||""%>" uniquemsg="此店铺编号已经存在">
                    </div>
                </div> 
                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>店铺名称：</label>
                    <div class="control">
                        <input type="text" name="salonname" value="<%=data.salonname%>" placeholder="店铺名称" maxlength="16" required>
                    </div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>所属商户：</label>
                    <div class="control">
                        <input type="text" name="name" value="<%=data.name%>" placeholder="所属商户" disabled>
                        <input type="hidden" name="merchantId" value="<%=data.merchantId%>">
                    </div>
                </div>

                <div class="control-group" style="margin-bottom:0">
                    <label class="control-label" for=""><span class="red">*</span>店铺地址：</label>
						<select id="province" name="provinceId" class="select min-width" required ajat-one="true" 
						ajat="salonList/getProvinces?type=1#domid=province&tempid=province_t&provinceId=<%=data.provinceId%>" ajat-change="salonList/getProvinces?type=2&areaId=${value}#domid=city&tempid=city_t&citiesId=<%=data.citiesId%>">
						</select>
						<select id="city" name="citiesId" class="select min-width" required ajat-one="true" 
						ajat="<%if(data.provinceId){%>salonList/getProvinces?type=2&areaId=<%=data.provinceId%><%}%>#domid=city&tempid=city_t&citiesId=<%=data.citiesId%>"
						ajat-change="salonList/getProvinces?type=3&areaId=${value}#domid=area&tempid=area_t&district=<%=data.district%>">
						</select>
                        
						<select id="area" name="district" class="select min-width" style="margin-right:10px" 
                        required ajat-one="true"
						ajat="<%if(data.citiesId){%>salonList/getProvinces?type=3&areaId=<%=data.citiesId%><%}%>#domid=area&tempid=area_t&district=<%=data.district%>"
						ajat-change="salonList/getProvinces?type=4&areaId=${value}#domid=zone&tempid=zone_t&zone=<%=data.zone%>"
						>
						</select>
						<span class="control-help" style="display:none;"></span>
						
                </div>

                <div class="control-group" style="margin:0">
                    <label class="control-label" for=""></label>
                    <textarea class="textarea" name="addr" id="address" placeholder="详细街道信息" 
                    maxlength="50" required ><%=data.addr%></textarea>
                </div>                  

                <div class="control-group" style="margin:0">
                    <label class="control-label" for=""></label>
                    <div class="textarea-bar">
                        <span class="area-coor">地理坐标：</span>
                        <span  id="coorMarker"><%=data.addrlati && data.addrlong ? '已标记':'未标记'%></span>                         
                        <button class="btn area-btn" id="addCoordinate" type="button">
                            <i class="fa fa-map-marker"></i> 
                            <span>添加坐标</span>
                        </button>
                    </div>
                    <input id="coorMarkerInput" name="lngLat" type='hidden' required requiredmsg="未标记"
                    value="<%=data.addrlati && data.addrlong ? data.addrlati+','+data.addrlong:''%>">
                    <span class="control-help"  style="display:none;"></span>
                </div>    

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>所属商圈：</label>

					<div class="control control-circle" id="zone" ajat="salonList/getProvinces?type=4&areaId=<%=data.district%>#domid=zone&tempid=zone_t&zone=<%=data.zone%>">

					</div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>店铺类型：</label>
                    <input type="radio" class="radio" id="radio1" name="shopType" value="1"
                    <%=data.shopType==1 ?"checked":""%>>
                    <label for="radio1">预付款店</label>
                    <input type="radio" class="radio" id="radio2" name="shopType" value="2" 
                    <%=data.shopType==2 ?"checked":""%>>
                    <label for="radio2">投资店</label>
                    <input type="radio" class="radio" id="radio3" name="shopType" value="3"
                    <%=data.shopType==3 ?"checked":""%>>
                    <label for="radio3">金字塔店</label>
                    <span class="control-help" style="display:none;"></span>
                </div> 

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>合同编号：</label>
                    <div class="control">
                        <input type="text" name="bargainno" value="<%=data.bargainno%>" placeholder="合同编号" maxlength="16" required>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>合同日期：</label>
                    <div class="control">
                        <%
                        if(!isNaN(data.contractTime)){
                            var date = new Date(+data.contractTime * 1000);
                            var year  = date.getFullYear();
                            var month = (+date.getMonth()+1) < 9 ? "0"+(+date.getMonth()+1) : +date.getMonth()+1;
                            var day   = (+date.getDate()) < 9 ? "0"+(+date.getDate()) : date.getDate();
                            data.contractTime = year + "-" + month + "-" + day;
                        }
                        %>
                        <input type="date" name="contractTime" value="<%=data.contractTime%>" required 
                        min="1950-01-01" max="2030-01-01">
                    </div>
                </div>  

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>合同限期：</label>
                    <%
                     var arr = [];
                     if(data.contractPeriod){
                        arr = data.contractPeriod.split("_");
                     }else{
                        arr[0] = 3;
                        arr[1] = 0;
                     }
                    %>
                    <select class="select min-width" name="contractLimitY">
                        <option value="0" <%=arr[0]==0 ? 'selected' : ''%> >0年</option>
                        <option value="1" <%=arr[0]==1 ? 'selected' : ''%> >1年</option>
                        <option value="2" <%=arr[0]==2 ? 'selected' : ''%> >2年</option>
                        <option value="3" <%=arr[0]==3 ? 'selected' : ''%> >3年</option>
                        <option value="4" <%=arr[0]==4 ? 'selected' : ''%> >4年</option>
                        <option value="5" <%=arr[0]==5 ? 'selected' : ''%> >5年</option>
                        <option value="6" <%=arr[0]==6 ? 'selected' : ''%> >6年</option>
                        <option value="7" <%=arr[0]==7 ? 'selected' : ''%> >7年</option>
                        <option value="8" <%=arr[0]==8 ? 'selected' : ''%> >8年</option>
                        <option value="9" <%=arr[0]==9 ? 'selected' : ''%> >9年</option>
                        <option value="10"<%=arr[0]==10 ? 'selected' : ''%>>10年</option>
                    </select>

                    <select class="select min-width" name="contractLimitM">
                        <option value="0" <%=arr[1]==0 ? 'selected' : ''%>>0月</option>
                        <option value="1" <%=arr[1]==1 ? 'selected' : ''%>>1月</option>
                        <option value="2" <%=arr[1]==2 ? 'selected' : ''%>>2月</option>
                        <option value="3" <%=arr[1]==3 ? 'selected' : ''%>>3月</option>
                        <option value="4" <%=arr[1]==4 ? 'selected' : ''%>>4月</option>
                        <option value="5" <%=arr[1]==5 ? 'selected' : ''%>>5月</option>
                        <option value="6" <%=arr[1]==6 ? 'selected' : ''%>>6月</option>
                        <option value="7" <%=arr[1]==7 ? 'selected' : ''%>>7月</option>
                        <option value="8" <%=arr[1]==8 ? 'selected' : ''%>>8月</option>
                        <option value="9" <%=arr[1]==9 ? 'selected' : ''%>>9月</option>
                        <option value="10" <%=arr[1]==10 ? 'selected' : ''%>>10月</option>
                        <option value="11" <%=arr[1]==11 ? 'selected' : ''%>>11月</option>
                    </select>
                </div> 


                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>联系人：</label>
                    <div class="control">
                        <input type="text" name="bcontacts" value="<%=data.bcontacts%>" placeholder="联系人" maxlength="8" required>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>联系电话：</label>
                    <div class="control">
                        <input type="text" name="tel" value="<%=data.tel%>" placeholder="11位有效手机号码" 
                        maxlength="11" pattern="mobile" patternmsg="请输入11位有效手机号" required>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>店铺电话：</label>
                    <div class="control">
                        <input type="text" name="phone" value="<%=data.phone%>" placeholder="店铺电话" maxlength="12" 
                        pattern="^\d{7,12}$" patternmsg="请输入7-12位有效店铺电话" required>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>法人代表：</label>
                    <div class="control">
                        <input type="text" name="corporateName" value="<%=data.corporateName%>" placeholder="法人代表" 
                        maxlength="8" required>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>法人电话：</label>
                    <div class="control">
                        <input type="text" name="corporateTel" value="<%=data.corporateTel%>" placeholder="11位有效手机号码" 
                        maxlength="11" pattern="mobile" patternmsg="请输入11位有效手机号" required>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>业务代表：</label>
                    <select class="select defalut-width" name="businessId" id="business" required 
                    ajat="salonList/getBussesName#domid=business&tempid=business_t&businessId=<%=data.businessId%>">

                    </select>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""></label>
                    <button class="btn" type="button" id="preview-btn" style="margin-right:20px">预览</button>
                    <button class="btn-primary">下一步</button>
                </div>
                </script>                                                                                                   
            </form>       
        </div>

        <div id="pop-wrapper" class="hide">
            <div class="mask"></div>
            <div class="pop">
                <div class="pop-header-wrapper">
                    <span class="pop-tip">标记地理坐标</span>
                    <span class="pop-close">×</span>
                </div>
                <div class="pop-search-wrapper">
                    <input  type="text" placeholder="" id="map-search" placeholder="请输入关键字" />
                </div>
                <div class="pop-map-wrapper" id="map-wrapper"></div>
                <div class="pop-bar-wrapper">
                    <div class="bar-mark">
                        <strong>标记位置：</strong>
                        <span id="pop-geo-coor">未标注</span>
                    </div>
                    <div class="bar-group">
                        <button class="btn"  id="pop-cancel-btn">取消</button>
                        <button class="btn-primary" id="pop-sure-btn">确定</button>
                    </div>
                </div>                                
            </div>        
        </div>

        <script type="text/template" id="province_t">
            <option value="">省份</option>
            <%for(var i=0;i<data.length;i++){%>
                <option <%=data[i].pid==protocol.custom.provinceId?"selected":""%> value="<%=data[i].pid%>"><%=data[i].pname%></option>
            <%}%>
        </script>

        <script type="text/template" id="city_t">
            <option value="">城市</option>
			<%if(data){%>
            <%for(var i=0;i<data.length;i++){%>
                <option <%=data[i].iid==protocol.custom.citiesId?"selected":""%> value="<%=data[i].iid%>"><%=data[i].iname%></option>
            <%}%>
			<%}%>
        </script>

        <script type="text/template" id="area_t">
            <option value="">地区</option>
			<%if(data){%>
            <%for(var i=0;i<data.length;i++){%>
                <option <%=data[i].tid==protocol.custom.district?"selected":""%> value="<%=data[i].tid%>"><%=data[i].tname%></option>
            <%}%>
			<%}%>
        </script>

        <script type="text/template" id="business_t">
            <option value="">请选择</option>
            <%for(var i=0;i<data.length;i++){%>
                <option <%=data[i].id == protocol.custom.businessId ? 'selected':''%> value="<%=data[i].id%>">
                <%=data[i].businessName%></option>
            <%}%>
        </script>
		<script type="text/template" id="zone_t">
			 <%for(var i=0;i<data.length;i++){%>
			<input type="radio" class="label" id="areaRadio<%=data[i].areaid%>" <%=data[i].areaid==protocol.custom.zone?"checked":""%>  name="zone" value="<%=data[i].areaid%>">
			<label for="areaRadio<%=data[i].areaid%>"><%=data[i].areaname%></label>
			<%}%>
			<span class="control-help" style="display:none;"></span>
		</script>
        <script src="http://api.map.baidu.com/api?v=2.0&ak=F360d7e9ea3c3ecb5b9b9f2b530be8f4&callback=renderMap()">
        </script>
        <script src="add.js"></script>
    </body>
</html>