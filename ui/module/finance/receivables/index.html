<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">    
        <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <meta name="format-detection" content="telephone=no">		
        <title>臭美管理后台</title>
        <script type="text/javascript" src="/js/include.js"></script>
    </head>
    <body>
            <div class="breadcrumb">
           <a>收款管理 </a><span>&gt;</span><a href="store/single/index.html">收款列表</a>
           <div class="flex-box">
            <div class="flex-item">
                <h4>收款列表</h4>
            </div>
            <div>
                <a class="btn-primary" href="edit.html"><i class="fa fa-plus" ></i>新增</a>
            </div>
        </div>
        </div>
        <div class="wrapper">
            <form data-role="hash"> 
                <div class="input-group input-switch">
					<select class="select" id="select">
						<option value="0">店铺名称</option>
						<option value="1">店铺编号</option>
						<option value="2">商户名称</option>
					</select>
				<input type="text" class="input-search" name="salonname" placeholder="请输入店铺名称">
				<input type="text" class="input-search hide" name="sn" class="hide" placeholder="请输入店铺编号">
				<input type="text" class="input-search hide" name="merchantName" class="hide" placeholder="请输入商户名称">								
				 </div>	
				 
			 
				 
                    <label>收款日期：</label>
                    <span class="date-group">
                      <input type="date" data-role="start" name="startTime"/>到<input type="date" data-role="end" name="endTime"/>
                      </span>
                      <button class="btn" type="submit">搜索</button>
                      <a class="btn" id="dropMenu">
              筛选条件 <i class="fa fa-angle-down"></i>
                </a>
                <button class="btn" form="export">导出</button>
				
                <div class="filter-box" style="display:none">
                    <div class="flex-box">
                        <div class="filter-title">收款类型：</div>
                        <div class="flex-item">
                            <label data-role="hash"><input type="radio" name="type" value="0" checked /><span>全部</span></label>
                            <label data-role="hash"><input type="radio" name="type" value="1" /><span>业务投资款返还</span></label>
                            <label data-role="hash"><input type="radio" name="type" value="2" /><span>交易代收款返还</span></label>              
                        </div>
                    </div>
					
                    <div class="flex-box">
                        <div class="filter-title">收款方式：</div>
                        <div class="flex-item">
                            <label data-role="hash"><input type="radio" name="paymentStyle" value="0" checked /><span>全部</span></label>
                            <label data-role="hash"><input type="radio" name="paymentStyle" value="1" /><span>银行存款</span></label>
                            <label data-role="hash"><input type="radio" name="paymentStyle" value="2" ><span>账扣返还</span></label>              
                            <label data-role="hash"><input type="radio" name="paymentStyle" value="3" /><span>现金</span></label>              
                            <label data-role="hash"><input type="radio" name="paymentStyle" value="4" /><span>支付宝</span></label>              
                            <label data-role="hash"><input type="radio" name="paymentStyle" value="5"/><span>财付通</span></label>              
                        </div>
                    </div> 
					
                    <div class="flex-box">
                        <div class="filter-title">收款状态：</div>
                        <div class="flex-item">
                            <label data-role="hash"><input type="radio" name="status" value="0" checked /><span>全部</span></label>
							<label data-role="hash"><input type="radio" name="status" value="1" /><span>待确认</span></label>   
                            <label data-role="hash"><input type="radio" name="status" value="2" /><span>已确认</span></label>
                                       
                        </div>
                    </div>
					
                </div>            
            </form>
            <form action="receivables/export" data-role="export" id="export"></form>    
		    <div class="table" ajat="receivables/index?<%=query._%>#domid=table&tempid=table-t" id="table">
			<script type="text/template" id="table-t">
                <table>
                    <thead>
                        <tr>
							<th width="50px"><label class="select-all"><input type="checkbox"/><span>全选</span></label></th>
                            <th>序号</th>
							<th>店铺编号</th>                       
							<th>店铺名称</th>
							<th>收款单号</th>						 
                            <th><a data-role="hash" href="#page=1&sort_key=type&sort_type=<%=query.sort_type=="desc"?"asc":"desc"%>">收款类型 <i class="fa fa-sort"></i></a></th>                          
                            <th>收款金额</th>
							<th><a data-role="hash" href="#page=1&sort_key=type&sort_type=<%=query.sort_type=="desc"?"asc":"desc"%>">收款方式 <i class="fa fa-sort"></i></a></th>							
							<th><a data-role="hash" href="#page=1&sort_key=day&sort_type=<%=query.sort_type=="desc"?"asc":"desc"%>">收款日期 <i class="fa fa-sort"></i></a></th>			       
							<th><a data-role="hash" href="#page=1&sort_key=day&sort_type=<%=query.sort_type=="desc"?"asc":"desc"%>">创建日期<i class="fa fa-sort"></i></a></th>
                            <th>制单人</th>
                            <th><a data-role="hash" href="#page=1&sort_key=day&sort_type=<%=query.sort_type=="desc"?"asc":"desc"%>">状态<i class="fa fa-sort"></i></a></th>
                            <th>操作</th>
                        </tr>
                    </thead>
					
               <tbody>
			   <%if(data.data){%>
				<%var type=["","业务投资款返还","交易代收款返还"]%>
				<%var status=["","待确认","已确认"]%>
				<%var paymentStyle=["","银行存款","账扣返还","现金","支付宝","财付通"]%>
				<%var data=data.data%>
				<%data.forEach(function(item,i){%>
				<tr>
					<td><label><input type="checkbox"/><span></span></label></td>
					<td><%=i+1%></td>
					<td><%=item.sn%></td>
					<td><%=item.salonname%></td>
					<td><%=item.singleNumber%></td>
					<td><%=type[item.type]%></td>					 
					<td><%=item.money%></td>
					<td><%=item.paymentStyle%></td>
					<td>
					
					</td>				 
					<td>
					<%
                                        if(data.addTime==0){
                                            data.addTime = "";
                                        }else if(!isNaN(data.addTime)){
                                            data.addTime = lib.tools.getDate(data.addTime);
                                        }
                                        %>
					<%=item.addTime%>
					</td>
					<td><%=item.preparedByName%></td>				 
					<td><%=status[item.status]%></td>
					  
					<td><a class="link" href="detail.html?id=<%=item.id%>" data-slug="shop_count.show,shop_count.update">查看</a></td>
                  </tr>
				  <%})%>
				  <%}%>
              </tbody>
            </table>
			
			<div class="table-bottom">
				<label class="select-all"><input type="checkbox"/><span>全选</span></label>
				<span class="space"></span>
				<!--<button class="btn"><a class="btn" href="edit.html?id=<%=data.id%>">确认收款</a></button>-->
			<form action="/receivables/confirmAct/<%=data.id%>" data-role="remove" data-title="你正在对<%=data.name%>家商户确认收款，收款金额<%=data.money%>，是否继续？" id="form-remove">
				<input type="hidden" name="id" value="<%=data.id%>" />
				<button class="btn" name="id" value="<%=data.id%>">确认收款</button>			 
			</form>	
			</div>
			
            <div class="pager"> </div>
			</script>
        </div>
    </div>
	<script type="text/javascript">
		 
		  $("#dropMenu").on('click',function(e){
              var box=$(".filter-box").fadeToggle(300);
              var icon=$(this).find('i');
              if(icon.hasClass('fa-angle-down')){
                  icon.removeClass('fa-angle-down').addClass('fa-angle-up');
              }else{
                  $(this).find('i').removeClass('fa-angle-up').addClass('fa-angle-down');
              }
        })
	</script>
</body>
</html>