<!DOCTYPE html>
<html lang="zh-CN">
    <head>
      <meta charset="utf-8">
      <title>臭美管理后台</title>
      <script type="text/javascript" src="/js/include.js"></script>
      <style>
        textarea{
            height:150px!important;
            width:500px!important;            
        }
      </style> 
    </head>
    <body>
        <div class="breadcrumb">
            <a>券活动管理</a>
            <span>&gt;</span>
            <a href="index.html">平台活动</a>
            <span>&gt;</span>新增活动
            <div class="flex-box">
                <div class="flex-item">
                    <h4>新增活动</h4>
                </div>
            </div>
            <hr />
        </div>

        <div class="wrapper">
            <form class="form-vertical" data-role="form" id="form">
            <script type="text/template" id="form-t">  
                <div class="detail-operation">
                    <button type="button" class="btn btn-cancel">取消</button>
                    <span class="space"></span>
                    <button class="btn-primary">提交</button>
                </div>
                
                <ul class="nav-step flex-box">
                    <li class="flex-item active">
                        <span class="arrow">1.活动基本信息</span>
                    </li>

                    <li class="flex-item">
                        <span>2.选择用户</span>
                    </li>

                    <li class="flex-item">
                        <span>3.定义现金券</span>
                    </li>
                </ul>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>活动名称：</label>
                    <div class="control">
                        <input type="text" name="actName" value="" placeholder="活动名称" 
                        maxlength="12" required value="<%=data.actName%>">
                    </div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>活动编号：</label>
                    <div class="control" id="control" ajat="<%if(!data.code){%>platform/getActNum<%}%>#domid=control&tempid=input-t" ajat-one="true">
 
                    </div>
                </div> 

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>活动简介：</label>
                    <div class="control">
                    <textarea maxlength="5000" name="actIntro" required placeholder="包含活动策划案例，时间，逻辑规则，限制1~5000个字符"  ><%=data.actIntro%></textarea>
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>申请部门：</label>
                    <div class="control">
                        <select name="department_id" id="department" required ajat-one="true" ajat="platform/getRequestDepartment#domid=department&tempid=department-t&departmentId=<%=data.departmentId%>"
                        ajat-change="paltform/getDepartmentManager/${value}#domid=manager&tempid=manager_t&managerId=<%=data.managerId%>">

                        </select>  
                    </div>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""><span class="red">*</span>负责人：</label>
                    <label class="label" id="manager" ajat-one="true" ajat="platform/getRequestDepartment/<%=data.departmentId || 0%>#domid=manager&tempid=manager-t&managerId=<%=data.managerId%>">

                    </label>
                    <span class="control-help" style="display:none;"></span>
                </div>

                <div class="control-group">
                    <label class="control-label" for=""></label>
                    <button class="btn" type="button" id="preview-btn" style="margin-right:20px">预览</button>
                    <button class="btn-primary">下一步</button>
                </div>
                </script>                                                                  
            </form>
            <script src="addBase.js"></script>
        </div> 

        <script type="text/template" id="input-t">  
            <input type="text" name="code" value="<%=data.code%>" readOnly>
        </script>

        <script type="text/template" id="department-t">  
            <option value="">全部</option>
            <%data.forEach&&data.forEach(function(item,i){%>
                <option <%=item.id==protocol.custom.departmentId?"selected":""%> value="<%=item.id%>">
                <%=item.title%>
                </option>
            <%})%>
        </script> 


        <script type="text/template" id="manager-t">  
        <%data.forEach&&data.forEach(function(item,i){%>
            <input type="radio" class="label" <%=item.id==protocol.custom.managerId?"checked":""%> name="managerId" 
            value="<%=itme.id%>" required>
            <span><%=itme.name%></span>  
        <%})%>     
        </script>        

        <script>
            lib.Form.prototype.save = function(data){
                location.href = "addUser.html"
            }
        </script>      
    </body>
</html>