<!DOCTYPE html>
<html lang="zh-CN">
    <head>
      <meta charset="utf-8">
      <title>臭美管理后台</title>
      <script type="text/javascript" src="/js/include.js"></script> 
    </head>
    <body>
        <div class="breadcrumb">
            <a>券活动管理</a>
            <span>&gt;</span>
            <a href="index.html">平台活动</a>
            <span>&gt;</span>新增活动
            <div class="flex-box">
                <div class="flex-item">
                    <h4>新增活动</h4>
                </div>
            </div>
            <hr />
        </div>

        <div class="wrapper">
				<div id="form" ajat="<%if(query._){%>laisee/show/<%=query.id%><%}%>#domid=form&tempid=form-t">
				<script type="text/template" id="form-t">
				<%if(query.id){sessionStorage.setItem("formData",JSON.stringify(data))}%>
				<form class="form-vertical" data-role="form">
                    <div class="detail-operation">
                        <a class="btn" href="index.html">取消</a>
                        <span class="space"></span>
                        <button class="btn-primary">提交</button>
                    </div>

                    <ul class="nav-step flex-box">
                        <li class="flex-item active"><span class="arrow">1.活动基本信息</span></li>
                        <li class="flex-item"><span>2.红包现金券配置</span></li>
                        <li class="flex-item"><span>3.礼包配置</span></li>
                        <li class="flex-item"><span>4.H5页面配置</span></li>
                    </ul>

                    <div class="control-group">
                        <label class="control-label" for=""><span class="red">*</span>红包名称：</label>
                        <div class="control">
                            <input type="text" name="laisee_name" maxlength="12" required value="<%=data.laisee_name%>" <%=query.id?"readonly":""%>>
                        </div>
                    </div> 

                    <div class="control-group">
                        <label class="control-label" for=""><span class="red">*</span>活动简介：</label>
                        <div class="control">
							<textarea name="lc_remark" placeholder="包含活动策划案例，时间，逻辑规则，限制5000个字符" required maxlength="5000" style="height:150px;width:400px;"><%=data.lc_remark%></textarea>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for=""><span class="red">*</span>红包的有效天数：</label>
                        <div class="control">
                            <input type="text" placeholder="从1开始的整数" name="effective" maxlength="6" pattern="number" min="1" required value="<%=data.over_time%>">
                        </div>
                    </div> 

                    <div class="control-group">
                        <label class="control-label" for=""><span class="red">*</span>活动领取金额上限：</label>
                        <div class="control">
                            <input type="text" placeholder="从1开始的整数" maxlength="6" name="total_money" pattern="number"  min="1" required value="<%=data.total_money%>">
                        </div>
                    </div>                                         

                    <div class="control-group">
                        <label class="control-label" for=""><span class="red">*</span>红包领取金额预警：</label>
                        <div class="control">
                            <select name="amount_warning" required >
                                <option <%=data.amount_warning==0?"selected":""%> value="0">无预警</option>
                                <option <%=data.amount_warning==1?"selected":""%> value="1">上限20%</option>
                                <option <%=data.amount_warning==2?"selected":""%> value="2">上限30%</option>
                                <option <%=data.amount_warning==3?"selected":""%> value="3">上限50%</option>
                                <option <%=data.amount_warning==4?"selected":""%> value="4">上限80%</option>
                                <option <%=data.amount_warning==5?"selected":""%> value="5">上限90%</option>
                                <option <%=data.amount_warning==6?"selected":""%> value="6">上限100%</option>
                            </select>
                        </div>
                    </div>

                    <div class="control-group">
                        <label class="control-label" for=""></label>
                        <div class="control">
                            <input type="text" name="warning_phone" placeholder="预警通知11位手机号，最多可填8个，用“，”区分" disabled required value="<%=data.warning_phone%>"/>
                        </div>                        
                    </div>                    

                    <div class="control-group">
                        <label class="control-label" for="">                            
                            <label>
                                <input type="checkbox" id="switch" value="3" <%=data.sms_on_gained?"checked":""%> >
                                <span>手机短信内容</span>
                            </label>
                        </label>
                        <div class="control">
                            <textarea name="sms_on_gained"  <%=!data.sms_on_gained?"disabled":""%> placeholder="限制500个汉字的长度,[useMoney]:接收短信用户获取的现金券金额,[name]:活动名称,[overtime]:接收短信用户获取的现金券有效结束时间" 
                            style="height:150px;width:400px;" required><%=data.sms_on_gained%></textarea>
                        </div>                        

                    </div>

                    <div class="control-group">
                        <label class="control-label" for=""></label>
                        <a class="btn" href="index.html">取消</a>
                        <button class="btn-primary">下一步</button>
                    </div>                                                                  
            </form>
			</script>
			</div>
        </div> 
        <script>
			lib.ajax({url:"laisee/itemTypes"}).done(function(data){
				if(data.result==1){
					sessionStorage.setItem("types",JSON.stringify(data.data));
				}
			})
			$(document.body).on('click',"#switch",function(){
				$(this).closest('.control-label').next().find("textarea").attr('disabled',!this.checked)
			}).on('change',"select[name='amount_warning']",function(){
				$(this).closest('.control-group').next().find("input").attr("disabled",this.value=="0"?true:false);
			});
            lib.Form.prototype.save = function(data){
				var formData=sessionStorage.getItem("formData")?JSON.parse(sessionStorage.getItem("formData")):{};
				data=$.extend(formData,data);
				sessionStorage.setItem("formData",JSON.stringify(data));
                location.href = "addTicket.html"+(lib.query._?"?"+lib.query._:"")
            }
        </script>      
    </body>
</html>