<!DOCTYPE html>
<html lang="zh-CN">
    <head>
      <meta charset="utf-8">
      <title>臭美管理后台</title>
      <script type="text/javascript" src="/js/include.js"></script> 
      <style>
      .title{
          display: inline-block;
          font-weight: bold;
          font-size: 15px;
          padding-left: 5px;
          width: 150px;"        
      }
      table{
        margin : 30px;
      }
      </style>
    </head>
    <body>
        <div class="breadcrumb">
            <a>券活动管理</a>
            <span>&gt;</span>
            <a href="index.html">平台活动</a>
            <span>&gt;</span>新增活动
            <div class="flex-box">
                <div class="flex-item">
                    <h4>新增活动</h4>
                </div>
            </div>
            <hr />
        </div>
        <div class="wrapper">
			<div id="form" ajat="<%if(query._){%>laisee/show/<%=query.id%><%}%>#domid=form&tempid=form-t">
				<script type="text/template" id="form-t">
				<form action="<%if(query._){%>laisee/update<%}else{%>laisee/create<%}%>" class="form-vertical" data-role="form" >
					<div class="detail-operation ">
						<button type="button" class="btn btn-cancel">取消</button>
						<span class="space"></span>
						<button class="btn-primary">提交</button>
					</div>
					<input type="hidden" value="<%=query.id%>" name="id" />
					<div class="control-group">
						<legend>
						微信/朋友圈分享icon
						</legend>
					</div>
					<div class="control-group">
						<label class="control-label" for="">
							<span class="red">*</span>分享图
						</label>
						<div class="control">
							<div class="control-image">
								<div class="control-single-image">
									<img src="<%=data.share_icon%>" alt="" />
									<div class="control-image-ud">
										<div id="imageUpload1"><i class="fa fa-cloud-upload"></i>上传图分享图</div>
									</div>
									<input type="hidden" name="share_icon" class="original" value="<%=data.share_icon%>" required requiredmsg="请上传分享图" data-helpid="image-help1" />
								</div>
							</div>   
							<div class="weak">分享图360*360px</div>
							<div id="image-help1" class="control-help" style="display:none"></div>
						</div>                        
					</div> 
					<div class="control-group">
						<label class="control-label" for="">
							<span class="red">*</span>分享标题
						</label>
						<div class="control">
							<input type="text" value="<%=data.share_title%>" placeholder="填写分享标题" style="width:300px" name="share_title" required maxlength="24"/>
						</div>                        
					</div> 
					<div class="control-group">
						<label class="control-label" for="">
							<span class="red">*</span>分享摘要
						</label>
						<div class="control">
							<textarea type="text" value="<%=data.share_desc%>" placeholder="填写分享摘要" style="width:300px" name="share_desc" required  maxlength="28"><%=data.share_desc%></textarea>
						</div>                        
					</div> 
					<div class="control-group">
						<legend>
							H5红包页面背景图
						</legend>
					</div>
					<div class="control-group">
						<label class="control-label" for="">
							<span class="red">*</span>背景图
						</label>
						<div class="control">
							<div class="control-image">
								<div class="control-single-image">
									<img src="<%=data.bonus_bg_img%>" alt="" style="width:320px" />
									<div class="control-image-ud">
										<div id="imageUpload2"><i class="fa fa-cloud-upload"></i>上传背景图</div>
									</div>
									<input type="hidden" name="bonus_bg_img" class="original" value="<%=data.bonus_bg_img%>" required requiredmsg="请上传背景图" data-helpid="image-help2" />
								</div>
							</div>
							<div class="weak">H5页面宽度为640px；背景高度根据实际效果图截取</div>
							<div id="image-help2"  class="control-help"  style="display:none"></div>					
						</div>				
					</div>
					<div class="control-group">
						<label class="control-label" for=""></label>
						<div class="control">
							 <button class="btn" type="button" id="preview_btn">预览</button>
							 <span class="space"></span>
							<button class="btn-primary" >提交</button>  
						</div>                        
					</div>
				</div> 
			</form>
			</script>
		</div>
		</div>
        <script>
			$('#form').on("_ready",function(){
				$('#form form')[0]._getFormData = function(){
					var data=lib.tools.getFormData($(this));
					var formData=sessionStorage.getItem("formData")?JSON.parse(sessionStorage.getItem("formData")):{};
					data=$.extend(formData,data);
					return data;
				 }
				lib.puploader.image({
					browse_button: 'imageUpload1',
					auto_start:true,
					filters: {
						mime_types : [
							{ title : "Image files", extensions : "jpg,png,jpeg" }
						]
					},
					max_file_size:'2mb',
					//imageLimitSize:"360x360"
				});
				lib.puploader.image({
					browse_button: 'imageUpload2',
					auto_start:true,
					filters: {
						mime_types : [
							{ title : "Image files", extensions : "jpg,png,jpeg" }
						]
					},
					max_file_size:'2mb',
					//imageLimitSize:"640"
				});
				$('#preview_btn').on('click',function(){
					var data=lib.tools.getFormData($("form"));
					var formData=sessionStorage.getItem("formData")?JSON.parse(sessionStorage.getItem("formData")):{};
					data=$.extend(formData,data);
					sessionStorage.setItem("preview",JSON.stringify(data));
					window.open("preview.html","_blank");
				})
			});
        </script>      
    </body>
</html>